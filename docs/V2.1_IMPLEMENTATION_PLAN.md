# Key-Face-Frame v2.1 å®æ–½è®¡åˆ’

> **è¯¦ç»†æŠ€æœ¯è®¾è®¡æ–‡æ¡£** - ç”¨äºæŒ‡å¯¼v2.1ç‰ˆæœ¬çš„å¼€å‘å®æ–½
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-11
> **é¢„è®¡å®Œæˆ**: 2025-12-31ï¼ˆ13-20å¤©ï¼‰

## é¡¹ç›®èƒŒæ™¯

**å½“å‰çŠ¶æ€**: v2.0 Webåº”ç”¨å·²å®Œæˆ
- Reactå‰ç«¯ + FastAPIåç«¯ + Celeryå¼‚æ­¥å¤„ç†
- åŸºæœ¬åŠŸèƒ½ï¼šä¸Šä¼ è§†é¢‘ã€å®æ—¶è¿›åº¦ã€å…³é”®å¸§å±•ç¤ºã€æ‰¹é‡ä¸‹è½½
- 1å¤©è·å¾—11ä¸ªstarï¼Œè¯´æ˜é¡¹ç›®æœ‰å¸‚åœºä»·å€¼

**v2.1ç›®æ ‡**: ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ï¼ˆæŒ‰ç”¨æˆ·ä¼˜å…ˆçº§ï¼‰
1. **å…³é”®å¸§ç¼–è¾‘å’Œæ ‡æ³¨** - ç”¨æˆ·å¯åˆ é™¤ã€æ ‡è®°ã€æ·»åŠ å¤‡æ³¨åˆ°å…³é”®å¸§
2. **å†å²è®°å½•é¡µé¢** - æŸ¥çœ‹æ‰€æœ‰å¤„ç†è¿‡çš„è§†é¢‘ï¼Œæ”¯æŒç­›é€‰ã€æ’åºã€åˆ é™¤
3. **æ‰¹é‡å¤„ç†å¤šä¸ªè§†é¢‘** - ä¸€æ¬¡ä¸Šä¼ å¤šä¸ªè§†é¢‘ï¼Œé˜Ÿåˆ—ç®¡ç†ï¼Œå¹¶è¡Œåº¦å¯é…ç½®

## å…³é”®æŠ€æœ¯å†³ç­–

åŸºäºç”¨æˆ·é€‰æ‹©ï¼Œç¡®å®šä»¥ä¸‹æŠ€æœ¯æ–¹æ¡ˆï¼š

### 1. æ•°æ®åº“è¿ç§»ç­–ç•¥ï¼šé‡å»ºæ•°æ®åº“
- **åŸå› **ï¼šé¡¹ç›®å¤„äºæ—©æœŸé˜¶æ®µï¼Œæš‚æ— é‡è¦ç”Ÿäº§æ•°æ®
- **æ–¹æ¡ˆ**ï¼šåˆ é™¤ç°æœ‰SQLiteæ•°æ®åº“ï¼Œä½¿ç”¨æ›´æ–°åçš„æ¨¡å‹é‡æ–°åˆ›å»º
- **æ“ä½œ**ï¼š`rm backend/keyframe.db` ç„¶åå¯åŠ¨åº”ç”¨è‡ªåŠ¨åˆ›å»º
- **æ³¨æ„**ï¼šç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰éœ€æ·»åŠ Alembicè¿ç§»ç³»ç»Ÿ

### 2. æ‰¹é‡å¤„ç†ç­–ç•¥ï¼šç”¨æˆ·å¯é…ç½®å¹¶è¡Œåº¦
- **é»˜è®¤**ï¼šé¡ºåºå¤„ç†ï¼ˆconcurrency=1ï¼‰
- **å¯é€‰**ï¼š2-3ä¸ªå¹¶è¡Œï¼ˆç”¨æˆ·åœ¨æ‰¹é‡ä¸Šä¼ æ—¶é€‰æ‹©ï¼‰
- **é™åˆ¶**ï¼šCelery worker poolé™åˆ¶æœ€å¤§3ä¸ªå¹¶å‘ä»»åŠ¡
- **å®ç°**ï¼šBatchJobè¡¨å¢åŠ `concurrency`å­—æ®µï¼ŒCeleryåŠ¨æ€è°ƒåº¦

### 3. æ ‡æ³¨å­˜å‚¨ï¼šç‹¬ç«‹æ•°æ®è¡¨KeyframeAnnotation
- **ä¼˜ç‚¹**ï¼šæ˜“äºæŸ¥è¯¢ã€æ‰©å±•ã€è¿ç§»
- **ç»“æ„**ï¼švideo_id + frame_index + notes + tags + is_deleted
- **å…³è”**ï¼šé€šè¿‡video_idå’Œframe_indexå…³è”åˆ°å…·ä½“å…³é”®å¸§

### 4. åˆ é™¤ç­–ç•¥ï¼šç”¨æˆ·å¯é€‰ï¼ˆè½¯åˆ é™¤/ç¡¬åˆ é™¤ï¼‰
- **è½¯åˆ é™¤**ï¼šæ ‡è®°`is_deleted=true`ï¼Œä¿ç•™æ•°æ®å’Œæ–‡ä»¶ï¼Œå¯æ¢å¤
- **ç¡¬åˆ é™¤**ï¼šåˆ é™¤æ•°æ®åº“è®°å½•å’Œç£ç›˜æ–‡ä»¶ï¼Œä¸å¯æ¢å¤
- **UI**ï¼šåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†æä¾›ä¸¤ä¸ªé€‰é¡¹

## æ•°æ®åº“è®¾è®¡

### æ–°å¢å­—æ®µåˆ°Videoæ¨¡å‹

```python
class Video(Base):
    # ç°æœ‰å­—æ®µä¿æŒä¸å˜

    # v2.1æ–°å¢å­—æ®µ
    is_deleted: bool = False                    # è½¯åˆ é™¤æ ‡è®°
    deleted_at: datetime | None = None          # åˆ é™¤æ—¶é—´
    thumbnail_path: str | None = None           # ç¼©ç•¥å›¾è·¯å¾„ï¼ˆç¬¬ä¸€å¸§æˆ–æœ€ä½³å¸§ï¼‰
    duration_seconds: float | None = None       # è§†é¢‘æ—¶é•¿ï¼ˆç”¨äºæ’åºï¼‰
    file_size: int | None = None               # æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
    tags: list[str] = []                       # è§†é¢‘æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰
    batch_id: str | None = None                # æ‰¹æ¬¡IDï¼ˆå±äºå“ªä¸ªæ‰¹æ¬¡ï¼‰
    batch_position: int | None = None          # æ‰¹æ¬¡ä¸­çš„ä½ç½®
```

### æ–°å¢æ¨¡å‹ï¼šKeyframeAnnotation

```python
class KeyframeAnnotation(Base):
    __tablename__ = "keyframe_annotations"

    id: str = Field(default_factory=lambda: str(uuid4()), primary_key=True)
    video_id: str                              # å…³è”Video.id
    frame_index: int                           # å…³é”®å¸§ç´¢å¼•
    notes: str | None = None                   # ç”¨æˆ·å¤‡æ³¨
    tags: list[str] = []                       # æ ‡ç­¾åˆ—è¡¨ï¼ˆå¦‚ï¼š"å¥½é•œå¤´", "å¾…å®š"ï¼‰
    is_deleted: bool = False                   # ç”¨æˆ·æ ‡è®°åˆ é™¤
    created_at: datetime = Field(default_factory=datetime.utcnow)
    updated_at: datetime = Field(default_factory=datetime.utcnow)

    # å¤åˆå”¯ä¸€ç´¢å¼•
    __table_args__ = (UniqueConstraint('video_id', 'frame_index'),)
```

### æ–°å¢æ¨¡å‹ï¼šBatchJob

```python
class BatchJob(Base):
    __tablename__ = "batch_jobs"

    id: str = Field(default_factory=lambda: str(uuid4()), primary_key=True)
    name: str                                  # æ‰¹æ¬¡åç§°ï¼ˆå¦‚"2025-12-11æ‰¹æ¬¡"ï¼‰
    total_videos: int                          # æ€»è§†é¢‘æ•°
    concurrency: int = 1                       # å¹¶è¡Œåº¦ï¼ˆ1-3ï¼‰

    # çŠ¶æ€ç»Ÿè®¡
    pending_count: int = 0
    processing_count: int = 0
    completed_count: int = 0
    failed_count: int = 0

    # é…ç½®ï¼ˆåº”ç”¨åˆ°æ‰€æœ‰è§†é¢‘ï¼‰
    sample_rate: int = 5
    max_frames: int = 20
    confidence_threshold: float = 0.5

    # æ—¶é—´æˆ³
    created_at: datetime = Field(default_factory=datetime.utcnow)
    started_at: datetime | None = None
    completed_at: datetime | None = None
```

## åç«¯APIè®¾è®¡

### 1. æ ‡æ³¨ç›¸å…³API (æ–°å¢)

```python
# backend/api/routes/annotation.py

# åˆ›å»º/æ›´æ–°æ ‡æ³¨
POST /api/videos/{video_id}/keyframes/{frame_index}/annotation
Request: { "notes": "å¥½é•œå¤´", "tags": ["ç²¾å½©", "ä¸»è§’"], "is_deleted": false }
Response: { "id": "...", "video_id": "...", "frame_index": 100, ... }

# è·å–è§†é¢‘æ‰€æœ‰æ ‡æ³¨
GET /api/videos/{video_id}/annotations
Response: { "annotations": [ {...}, {...} ] }

# æ‰¹é‡æ›´æ–°æ ‡æ³¨ï¼ˆä¸€æ¬¡æ ‡è®°å¤šä¸ªå…³é”®å¸§ï¼‰
POST /api/videos/{video_id}/annotations/batch
Request: { "updates": [ { "frame_index": 100, "tags": ["ç²¾å½©"] }, ... ] }
Response: { "updated": 5 }

# åˆ é™¤æ ‡æ³¨
DELETE /api/videos/{video_id}/keyframes/{frame_index}/annotation
Response: { "message": "Annotation deleted" }
```

### 2. å†å²è®°å½•API (æ‰©å±•)

```python
# backend/api/routes/video.py

# åˆ—å‡ºæ‰€æœ‰è§†é¢‘ï¼ˆæ”¯æŒåˆ†é¡µã€ç­›é€‰ã€æ’åºï¼‰
GET /api/videos?page=1&page_size=20&status=completed&sort_by=created_at&order=desc
Response: {
  "total": 50,
  "page": 1,
  "page_size": 20,
  "videos": [
    {
      "id": "...",
      "filename": "video.mp4",
      "thumbnail_url": "/files/video-.../thumbnail.jpg",
      "status": "completed",
      "duration_seconds": 30.5,
      "keyframes_extracted": 20,
      "created_at": "2025-12-11T10:00:00Z",
      "tags": ["äººç‰©", "ç²¾å½©"]
    },
    ...
  ]
}

# åˆ é™¤è§†é¢‘ï¼ˆè½¯åˆ é™¤æˆ–ç¡¬åˆ é™¤ï¼‰
DELETE /api/videos/{video_id}?hard=false
Request: { "hard": false }  # false=è½¯åˆ é™¤, true=ç¡¬åˆ é™¤
Response: { "message": "Video soft deleted", "can_restore": true }

# æ¢å¤è½¯åˆ é™¤çš„è§†é¢‘
POST /api/videos/{video_id}/restore
Response: { "message": "Video restored" }

# æ›´æ–°è§†é¢‘æ ‡ç­¾
PUT /api/videos/{video_id}/tags
Request: { "tags": ["åŠ¨ç”»", "äººç‰©", "ç²¾å½©"] }
Response: { "id": "...", "tags": [...] }
```

### 3. æ‰¹é‡å¤„ç†API (æ–°å¢)

```python
# backend/api/routes/batch.py

# æ‰¹é‡ä¸Šä¼ è§†é¢‘
POST /api/batch/upload
Request: FormData {
  files: [File, File, File],
  name: "2025-12-11æ‰¹æ¬¡",
  concurrency: 2,                    # å¹¶è¡Œåº¦ï¼ˆ1-3ï¼‰
  sample_rate: 5,
  max_frames: 20,
  confidence_threshold: 0.5
}
Response: {
  "batch_id": "...",
  "name": "2025-12-11æ‰¹æ¬¡",
  "total_videos": 3,
  "video_ids": ["id1", "id2", "id3"],
  "message": "Batch created, processing started"
}

# æŸ¥è¯¢æ‰¹æ¬¡çŠ¶æ€
GET /api/batch/{batch_id}/status
Response: {
  "batch_id": "...",
  "name": "2025-12-11æ‰¹æ¬¡",
  "total_videos": 3,
  "pending_count": 0,
  "processing_count": 1,
  "completed_count": 2,
  "failed_count": 0,
  "progress": 66.7,                  # æ€»ä½“è¿›åº¦ç™¾åˆ†æ¯”
  "videos": [                        # æ¯ä¸ªè§†é¢‘çš„çŠ¶æ€
    { "video_id": "id1", "filename": "v1.mp4", "status": "completed", "progress": 100 },
    { "video_id": "id2", "filename": "v2.mp4", "status": "processing", "progress": 50 },
    { "video_id": "id3", "filename": "v3.mp4", "status": "pending", "progress": 0 }
  ]
}

# å–æ¶ˆæ‰¹æ¬¡ï¼ˆåœæ­¢æœªå¼€å§‹çš„ä»»åŠ¡ï¼‰
POST /api/batch/{batch_id}/cancel
Response: { "message": "Batch cancelled", "stopped": 1, "already_completed": 2 }
```

## å®æ–½é˜¶æ®µåˆ’åˆ†

### Phase 0: æ•°æ®åº“é‡å»ºï¼ˆP0 - å¿…é¡»ï¼‰
**æ—¶é—´**ï¼š1å¤©

**æ“ä½œæ­¥éª¤**ï¼š
1. åœæ­¢æ‰€æœ‰æœåŠ¡ï¼ˆFastAPI, Celeryï¼‰
2. å¤‡ä»½ç°æœ‰æ•°æ®åº“ï¼š`cp backend/keyframe.db backend/keyframe.db.backup`
3. åˆ é™¤ç°æœ‰æ•°æ®åº“ï¼š`rm backend/keyframe.db`
4. æ›´æ–°æ¨¡å‹å®šä¹‰ï¼ˆbackend/models/ï¼‰
5. å¯åŠ¨åº”ç”¨ï¼ŒSQLAlchemyè‡ªåŠ¨åˆ›å»ºæ–°è¡¨

**éªŒæ”¶æ ‡å‡†**ï¼š
- å¯åŠ¨åº”ç”¨æ— é”™è¯¯
- æ•°æ®åº“åŒ…å«3å¼ è¡¨ï¼švideos, keyframe_annotations, batch_jobs
- Videoè¡¨åŒ…å«æ‰€æœ‰æ–°å­—æ®µ

### Phase 1: å…³é”®å¸§æ ‡æ³¨åŠŸèƒ½ï¼ˆP0 - æœ€é«˜ä¼˜å…ˆçº§ï¼‰
**æ—¶é—´**ï¼š3-4å¤©

**åç«¯å¼€å‘**ï¼ˆ1.5å¤©ï¼‰ï¼š
- åˆ›å»ºannotationè·¯ç”±å’Œschemas
- å®ç°CRUDæ“ä½œï¼ˆåˆ›å»º/è¯»å–/æ›´æ–°/åˆ é™¤æ ‡æ³¨ï¼‰
- æµ‹è¯•APIç«¯ç‚¹

**å‰ç«¯å¼€å‘**ï¼ˆ2-2.5å¤©ï¼‰ï¼š
- åˆ›å»ºannotationStoreï¼ˆZustandï¼‰
- å®ç°KeyframeEditorç»„ä»¶
- ä¿®æ”¹KeyframeGalleryé›†æˆæ ‡æ³¨æ˜¾ç¤º
- ä¿®æ”¹Resulté¡µé¢æ·»åŠ ç¼–è¾‘æ¨¡å¼

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] å¯ä¸ºä»»æ„å…³é”®å¸§æ·»åŠ å¤‡æ³¨ã€æ ‡ç­¾
- [ ] å¯æ ‡è®°å…³é”®å¸§ä¸º"åˆ é™¤"
- [ ] æ ‡æ³¨å®æ—¶ä¿å­˜ï¼ˆ500msé˜²æŠ–ï¼‰
- [ ] åˆ·æ–°é¡µé¢åæ ‡æ³¨æ•°æ®ä¿æŒ

### Phase 2: å†å²è®°å½•é¡µé¢ï¼ˆP1 - é‡è¦ï¼‰
**æ—¶é—´**ï¼š3-4å¤©

**åç«¯å¼€å‘**ï¼ˆ1.5å¤©ï¼‰ï¼š
- æ·»åŠ ç¼©ç•¥å›¾ç”Ÿæˆå’Œå…ƒæ•°æ®æå–
- å®ç°è§†é¢‘åˆ—è¡¨APIï¼ˆåˆ†é¡µã€ç­›é€‰ã€æ’åºï¼‰
- å®ç°åˆ é™¤/æ¢å¤/æ ‡ç­¾æ›´æ–°API

**å‰ç«¯å¼€å‘**ï¼ˆ2-2.5å¤©ï¼‰ï¼š
- åˆ›å»ºHistoryTableç»„ä»¶
- åˆ›å»ºHistoryé¡µé¢
- å®ç°åˆ†é¡µã€ç­›é€‰ã€æ’åºåŠŸèƒ½
- å®ç°åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†ï¼ˆè½¯åˆ é™¤/ç¡¬åˆ é™¤é€‰æ‹©ï¼‰

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] å†å²é¡µé¢åˆ—å‡ºæ‰€æœ‰è§†é¢‘ï¼ˆå«ç¼©ç•¥å›¾ï¼‰
- [ ] æ”¯æŒæŒ‰çŠ¶æ€ç­›é€‰ã€æŒ‰æ—¥æœŸ/æ–‡ä»¶åæ’åº
- [ ] æ”¯æŒåˆ†é¡µï¼ˆæ¯é¡µ20æ¡ï¼‰
- [ ] è½¯åˆ é™¤åå¯æ¢å¤ï¼Œç¡¬åˆ é™¤åæ°¸ä¹…åˆ é™¤

### Phase 3: æ‰¹é‡å¤„ç†åŠŸèƒ½ï¼ˆP1 - é‡è¦ï¼‰
**æ—¶é—´**ï¼š4-5å¤©

**åç«¯å¼€å‘**ï¼ˆ2-2.5å¤©ï¼‰ï¼š
- åˆ›å»ºæ‰¹é‡ä¸Šä¼ API
- å®ç°process_batch_taskï¼ˆæ”¯æŒå¯é…ç½®å¹¶è¡Œåº¦ï¼‰
- å®ç°æ‰¹æ¬¡çŠ¶æ€æŸ¥è¯¢å’Œå–æ¶ˆAPI

**å‰ç«¯å¼€å‘**ï¼ˆ2-2.5å¤©ï¼‰ï¼š
- åˆ›å»ºbatchStoreï¼ˆZustandï¼‰
- å®ç°BatchUploaderç»„ä»¶
- åˆ›å»ºBatchProcessingé¡µé¢
- å®ç°æ‰¹æ¬¡çŠ¶æ€è½®è¯¢

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] å¯ä¸€æ¬¡ä¸Šä¼ 3-10ä¸ªè§†é¢‘
- [ ] å¯é€‰æ‹©å¹¶è¡Œåº¦ï¼ˆ1/2/3ï¼‰
- [ ] æ‰¹æ¬¡é¡µé¢å®æ—¶æ˜¾ç¤ºå„è§†é¢‘è¿›åº¦
- [ ] å®Œæˆåå¯è·³è½¬æŸ¥çœ‹å„è§†é¢‘ç»“æœ

### Phase 4: é›†æˆæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆP1ï¼‰
**æ—¶é—´**ï¼š2-3å¤©

**æµ‹è¯•**ï¼ˆ1å¤©ï¼‰ï¼š
- E2Eæµ‹è¯•å®Œæ•´æµç¨‹
- è¾¹ç•Œæµ‹è¯•

**ä¼˜åŒ–**ï¼ˆ1å¤©ï¼‰ï¼š
- å†å²åˆ—è¡¨æ‡’åŠ è½½
- æ ‡æ³¨é˜²æŠ–ä¼˜åŒ–
- æ‰¹æ¬¡è½®è¯¢ä¼˜åŒ–

**æ–‡æ¡£**ï¼ˆ0.5å¤©ï¼‰ï¼š
- æ›´æ–°READMEå’ŒFAQ
- æ·»åŠ ä½¿ç”¨æˆªå›¾

### Phase 5: å¯é€‰å¢å¼ºï¼ˆP2 - å¯é€‰ï¼‰
**æ—¶é—´**ï¼š2-3å¤©

- è™šæ‹Ÿæ»šåŠ¨æ”¯æŒ
- é«˜çº§å¯¼å‡ºåŠŸèƒ½
- æ‰¹æ¬¡ç®¡ç†å¢å¼º

## å…³é”®æ–‡ä»¶æ¸…å•

### åç«¯
**æ–°å¢æ–‡ä»¶**ï¼ˆ6ä¸ªï¼‰ï¼š
1. backend/models/keyframe_annotation.py
2. backend/models/batch.py
3. backend/api/routes/annotation.py
4. backend/api/routes/batch.py
5. backend/api/schemas/annotation.py
6. backend/api/schemas/batch.py

**ä¿®æ”¹æ–‡ä»¶**ï¼ˆ4ä¸ªï¼‰ï¼š
1. backend/models/video.py
2. backend/workers/tasks.py
3. backend/api/routes/video.py
4. backend/main.py

### å‰ç«¯
**æ–°å¢æ–‡ä»¶**ï¼ˆ12ä¸ªï¼‰ï¼š
1. frontend/src/api/annotation.ts
2. frontend/src/api/batch.ts
3. frontend/src/stores/annotationStore.ts
4. frontend/src/stores/batchStore.ts
5. frontend/src/components/KeyframeEditor/index.tsx
6. frontend/src/components/HistoryTable/index.tsx
7. frontend/src/components/BatchUploader/index.tsx
8. frontend/src/components/BatchStatusPanel/index.tsx
9. frontend/src/pages/History/index.tsx
10. frontend/src/pages/BatchProcessing/index.tsx
11. frontend/src/hooks/useBatchStatus.ts
12. frontend/src/utils/validators.ts

**ä¿®æ”¹æ–‡ä»¶**ï¼ˆ7ä¸ªï¼‰ï¼š
1. frontend/src/api/types.ts
2. frontend/src/api/video.ts
3. frontend/src/components/KeyframeGallery/index.tsx
4. frontend/src/pages/Result/index.tsx
5. frontend/src/pages/Home/index.tsx
6. frontend/src/App.tsx
7. frontend/src/utils/constants.ts

## æŠ€æœ¯æ³¨æ„äº‹é¡¹

### æ€§èƒ½è€ƒè™‘
- **å†å²åˆ—è¡¨**ï¼šæœåŠ¡ç«¯åˆ†é¡µï¼ˆæ¯é¡µ20æ¡ï¼‰ã€ç¼©ç•¥å›¾æ‡’åŠ è½½ã€æµè§ˆå™¨ç¼“å­˜
- **æ ‡æ³¨æ›´æ–°**ï¼š500msé˜²æŠ–ã€ä¹è§‚æ›´æ–°ã€æ‰¹é‡æ›´æ–°API
- **æ‰¹æ¬¡å¤„ç†**ï¼šé™åˆ¶å¹¶è¡Œåº¦â‰¤3ã€é¡ºåºå¤„ç†ä¸ºé»˜è®¤ã€Celery poolé™åˆ¶

### å­˜å‚¨è€ƒè™‘
- **ç¼©ç•¥å›¾**ï¼š300x200pxï¼ŒJPEG 85%ï¼Œçº¦20-30KB/å¼ 
- **æ ‡æ³¨æ•°æ®**ï¼šæ¯æ¡çº¦200-500å­—èŠ‚ï¼Œ1000ä¸ªè§†é¢‘çº¦10MB
- **æ‰¹æ¬¡æ•°æ®**ï¼šæ¯ä¸ªæ‰¹æ¬¡è®°å½•<1KB

### å¹¶å‘å¤„ç†
- **æ•°æ®åº“**ï¼šSQLiteåºåˆ—åŒ–æ¨¡å¼ï¼ˆè‡ªåŠ¨åŠ é”ï¼‰
- **æ ‡æ³¨æ›´æ–°**ï¼šLast-write-winsç­–ç•¥ + 500msé˜²æŠ–
- **æ‰¹é‡å¤„ç†**ï¼šCelery worker poolæ§åˆ¶ï¼ˆ--concurrency=3ï¼‰

## é¢„ä¼°æ—¶é—´çº¿

| é˜¶æ®µ | æ—¶é—´ | ç´¯è®¡ | ä¼˜å…ˆçº§ |
|-----|------|------|--------|
| Phase 0: æ•°æ®åº“é‡å»º | 1å¤© | 1å¤© | P0 |
| Phase 1: å…³é”®å¸§æ ‡æ³¨ | 3-4å¤© | 4-5å¤© | P0 |
| Phase 2: å†å²è®°å½• | 3-4å¤© | 7-9å¤© | P1 |
| Phase 3: æ‰¹é‡å¤„ç† | 4-5å¤© | 11-14å¤© | P1 |
| Phase 4: æµ‹è¯•ä¼˜åŒ– | 2-3å¤© | 13-17å¤© | P1 |
| Phase 5: å¯é€‰å¢å¼º | 2-3å¤© | 15-20å¤© | P2 |

**æœ€å¿«å®Œæˆæ—¶é—´**ï¼š13å¤©ï¼ˆP0+P1ï¼‰
**å®Œæ•´å®Œæˆæ—¶é—´**ï¼š20å¤©ï¼ˆåŒ…å«P2å¯é€‰åŠŸèƒ½ï¼‰

## é£é™©å’Œç¼“è§£

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|-----|------|------|---------|
| æ•°æ®åº“é‡å»ºä¸¢å¤±æ•°æ® | é«˜ | ä½ | æå‰å¤‡ä»½ï¼›æ—©æœŸé¡¹ç›®å½±å“å° |
| å¹¶è¡Œå¤„ç†èµ„æºè€—å°½ | ä¸­ | ä¸­ | é»˜è®¤é¡ºåºå¤„ç†ï¼›é™åˆ¶å¹¶è¡Œåº¦â‰¤3 |
| æ ‡æ³¨æ›´æ–°å†²çª | ä½ | ä½ | é˜²æŠ–500msï¼›last-write-wins |
| æ‰¹é‡ä¸Šä¼ è¶…æ—¶ | ä¸­ | ä¸­ | åˆ†æ‰¹ä¸Šä¼ ï¼›æ¯æ‰¹â‰¤10ä¸ªï¼›æ˜¾ç¤ºè¿›åº¦ |

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **Phase 0** - æ•°æ®åº“é‡å»ºï¼ˆ1å¤©ï¼‰
2. **Phase 1** - å…³é”®å¸§æ ‡æ³¨ï¼ˆ3-4å¤©ï¼‰â†’ å‘å¸ƒv2.1-alpha
3. **Phase 2** - å†å²è®°å½•ï¼ˆ3-4å¤©ï¼‰
4. **Phase 3** - æ‰¹é‡å¤„ç†ï¼ˆ4-5å¤©ï¼‰
5. **Phase 4** - æµ‹è¯•ä¼˜åŒ–ï¼ˆ2-3å¤©ï¼‰â†’ å‘å¸ƒv2.1æ­£å¼ç‰ˆ

---

**è®¡åˆ’ç‰ˆæœ¬**ï¼šv2.1
**åˆ›å»ºæ—¥æœŸ**ï¼š2025-12-11
**æ ¸å¿ƒä»·å€¼**ï¼šæå‡ç”¨æˆ·ä½“éªŒï¼Œå¢åŠ æ•°æ®ç®¡ç†èƒ½åŠ›ï¼Œæ”¯æŒæ‰¹é‡åœºæ™¯

> ğŸ’¡ **ä½¿ç”¨è¯´æ˜**ï¼šæœ¬æ–‡æ¡£åŒ…å«å®Œæ•´çš„æŠ€æœ¯å®ç°ç»†èŠ‚ï¼ŒåŒ…æ‹¬æ•°æ®åº“è®¾è®¡ã€APIè®¾è®¡ã€å‰ç«¯ç»„ä»¶è®¾è®¡ç­‰ã€‚å¼€å‘æ—¶å¯éšæ—¶å‚è€ƒæœ¬æ–‡æ¡£ï¼Œæˆ–æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´åå¿«é€Ÿå¼€å§‹å¼€å‘éªŒè¯ã€‚
